<!DOCTYPE html>
<html lang="en">

<head>
    <title>Complaints Management</title>
    <link rel="stylesheet" href="BaseStyle.css">
</head>

<body>
    <!-- This part is uniform across all pages -->
    <header class="header">
        <h1>Welcome to "City Name"</h1>
        <h2>Home <br> of the <br> "Something"</h2>
    </header>

    <div class="navbar">
        <a href="Project1MainPage.html">Home</a>
        <a href="SubmitComplaint.html">Report a Complaint</a>
        <a href=ScheduledMeetingsPage.html>Attend a meeting</a>

        <div class="dropdown">
            <button class="dropbtn">Council Work
                <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
                <a href="Complaints.html">Complaints Management</a>
                <a href="#">Approve Registering Users</a>
                <a href="#">Approve Meeting Speakers</a>
            </div>
        </div>
        <a href="LoginPage.html">Login</a>
    </div>

    <!-- end of uniform portion -->


    <!-- Complaints table -->
    <table class="center" id="complaintTable">
        <thead>

            <tr>
                <th>Description</th>
                <th>Current Priority</th>
                <th>Change Priority</th>
                <th>Meeting Date</th>
                <th>Meeting Address</th>
                <th>Meeting Summary</th>
                <th>Change Meeting</th>
                <!-- <th>Meeting Address</th> -->
                <!-- look to replace the buttons with a datalist tag -->
            </tr>


        </thead>
        <tbody id="complaintList">
        </tbody>
    </table>

    <datalist id="StatusListOptions">
        <option value="high">
        <option value="low">
        <option value="resolved">
        <option value="ignored">
    </datalist>

    <datalist id="MeetingOptionsList"></datalist>
    <!-- Empty datalist container. Will add assignable meetings into this container-->
    <script type="text/javascript" src="/Scripts/ComplaintsScript.js"></script>
</body>


<script>

    // const complaintTable = document.getElementById("complaintTable");
    // const complaintList = document.getElementById("complaintList");
    // const meetingOptions = document.getElementById("MeetingOptionsList");

    // const meetingMap = new Map();

    // // const createMeetingButton = document.getElementById("createMeetingBtn")
    // // const backToMainListBtn = document.getElementById("backToMainListBtn");
    // // const meetingForm = document.getElementById("meetingForm");
    // // const submitNewMeetingBtn = document.getElementById("submitBtn");
    // // const specificMeetingTable = document.getElementById("specificMeetingTable");
    // // const specificInfo = document.getElementById("specificInfo");


    // // const basicInfo = document.getElementById("basicInfo");
    // // const addInfo = document.getElementById("addInfo");
    // // const sumInfo = document.getElementById("sumInfo");

    // // submit meeting button here
    // document.addEventListener("submit", async event => {
    //     event.preventDefault();
    // });

    // function ClearTables() {
    //     complaintTable.innerText = "";
    // }

    // function ShowSpecific() {
    //     // show specific
    //     specificMeetingTable.setAttribute("style", "display: table");
    //     backToMainListBtn.setAttribute("style", "display:block");

    //     // Hide Rest
    //     createMeetingButton.setAttribute("style", "display: none;");
    //     meetingTable.setAttribute("style", "display: none");
    // }

    // function HideSpecific() {
    //     // hide specific
    //     specificMeetingTable.setAttribute("style", "display: none");
    //     backToMainListBtn.setAttribute("style", "display: none");

    //     // show default
    //     createMeetingButton.setAttribute("style", "display: block");
    //     meetingTable.setAttribute("style", "display: table");
    // }

    // function ShowForm() {
    //     // show form
    //     meetingForm.setAttribute("style", "display: block;");

    //     // Hide Rest
    //     createMeetingButton.setAttribute("style", "display: none;");
    //     meetingTable.setAttribute("style", "display: none");
    // }

    // function HideForm() {
    //     // hide form
    //     meetingForm.setAttribute("style", "display: none");

    //     // show rest
    //     createMeetingButton.setAttribute("style", "display: block");
    //     meetingTable.setAttribute("style", "display: table");
    // }

    // async function GetAllComplaints() {

    //     let requestString = "http://localhost:8080/complaints";
    //     console.log(requestString);

    //     const response = await fetch(requestString);

    //     const complaints = await response.json();

        
    //     console.log(complaints);

    //     if (response.status === 200) {

    //         const meetings = await GetAllMeetings();

    //         // meetingOptions.innerText = "";
    //         if (response.status === 200) {

    //             meetingMap.length = 0;
                
    //             for (meeting of meetings) {
    //                 if (meeting.id <= 0) { continue; }
    //                 //   console.log(meeting);
    //                 const optionElement = document.createElement("option");
    //                 const option = meeting.summary;
    //                 optionElement.value = meeting.summary;

    //                 meetingMap.set(meeting.summary, meeting.id);
    //               //  meetingMap.push(`${meeting.summary}:${meeting.id}`);
    //              //   optionElement.dataset.meetingID = meeting.id;

    //                 meetingOptions.appendChild(optionElement);
    //             }
    //         }

    //         for (complaint of complaints) {

    //             const complaintRow = document.createElement("tr");

    //             const description = document.createElement("td");
    //             description.innerText = complaint.description;

    //             const status = document.createElement("td");
    //             status.innerText = complaint.status;

    //             //const statusChangeDropdown = document.createElement("dropdown");  // use dropdown someday instead of buttons if I can get it to work
    //             const btns = document.createElement("td");

    //             const aMeetingDate = document.createElement("td");
    //             let meeting = await GetMeetingByID(complaint.meetingID);

    //             console.log(meeting);
    //             let meetingDate = epochDate = new Date(meeting.scheduledDate * 1000);

    //             aMeetingDate.innerText = epochDate.toLocaleString();

    //             const aMeetingAddress = document.createElement("td");
    //             aMeetingAddress.innerText = meeting.address;

    //             const meetingSummary = document.createElement("td");
    //             meetingSummary.innerText = meeting.summary;

    //             // create list input using our status list options
    //             const changeStatusTD = document.createElement("td");

    //             const setStatusInput = document.createElement("input");
    //             setStatusInput.setAttribute('list', 'StatusListOptions');
    //             setStatusInput.dataset.id = complaint.id;

    //             setStatusInput.addEventListener('change', async event => {
    //                 await PatchComplaint(setStatusInput.dataset.id, event.target.value);
    //             });

    //             const changeMeetingTD = document.createElement("td");

    //             const setMeetingInput = document.createElement("input");
    //             setMeetingInput.setAttribute('list', 'MeetingOptionsList');

    //             setMeetingInput.dataset.id = complaint.id;
    //             setMeetingInput.addEventListener('change', async event => {
    //                 // set meeting
    //                 await SetMeetingAssignment(setMeetingInput.dataset.id, event.target.value);

    //             });


    //             changeStatusTD.appendChild(setStatusInput);

    //             complaintRow.appendChild(description);
    //             complaintRow.appendChild(status);

    //             complaintRow.appendChild(changeStatusTD);

    //             complaintRow.appendChild(aMeetingDate);
    //             complaintRow.appendChild(aMeetingAddress);
    //             complaintRow.appendChild(meetingSummary);
    //             complaintRow.appendChild(setMeetingInput);

    //             complaintList.appendChild(complaintRow);
    //         }
    //     }
    //     else {
    //         alert("Something went wrong");
    //     }
    // }

    // async function PatchComplaint(id, newStatus) {
    //     let requestString = `http://localhost:8080/complaints/${id}/${newStatus}`;
    //     console.log(requestString);
    //     const response = await fetch(requestString,
    //         {
    //             method: "PATCH"
    //         });

    //     if (response.status === 200) {
    //         alert("status updated");
    //         location.reload();
    //     }
    // }

    // async function SetMeetingAssignment(id, meetingSummary) {

    //     let meetingID = meetingMap.get(meetingSummary);
        
    //     // correct route now! just need to implement backend and then finish front end.
    //     let requestString = `http://localhost:8080/complaints/${id}/${meetingID}`;
    //     console.log(requestString);
    // }

    
    // async function GetMeetingByID(id) {

    //     let requestString = `http://localhost:8080/meetings/${id}`;

    //     console.log(requestString);
    //     const response = await fetch(requestString);

    //     let meeting = await response.json();

    //     return meeting;
    // }

    // async function GetAllMeetings() {

    //     let requestString = "http://localhost:8080/meetings";

    //     const response = await fetch(requestString);

    //     const meetings = await response.json();

    //     console.log(meetings);

    //     if (response.status === 200) {

    //         return meetings;
    //     }
    // }


    // // on first load
    // // meetingForm.setAttribute("style", "display: none");
    // //  specificMeetingTable.setAttribute("style", "display: none");
    // // backToMainListBtn.setAttribute("style", "display: none");

    // GetAllComplaints();

</script>

</html>